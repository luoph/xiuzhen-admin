<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.jeecg.modules.player.mapper.PlayerItemLogMapper">

    <!-- 通用查询映射结果 -->
    <resultMap id="BaseResultMap" type="org.jeecg.modules.player.entity.PlayerItemLog">
        <id column="id" property="id"/>
        <result column="sync_time" property="syncTime"/>
        <result column="item_num" property="itemNum"/>
        <result column="add_item_num" property="addItemNum"/>
        <result column="consume_item_num" property="consumeItemNum"/>
    </resultMap>

    <select id="queryCurrencyPayIncomeList" resultMap="BaseResultMap">
        SELECT
        sync_time,
        SUM(num) add_item_num
        FROM player_item_log
        WHERE
        item_id = #{itemId}
        AND type = #{type}
        AND sync_time >= #{rangeDateBeginTime} AND sync_time &lt;= #{rangeDateEndTime}
        <if test="serverId != 0">
            AND server_id = #{serverId}
        </if>
        GROUP BY sync_time
        ORDER BY sync_time DESC
    </select>

    <select id="getBySyncTime" resultType="BigDecimal">
        SELECT
        SUM(num) consume_item_num
        FROM player_item_log
        WHERE
        item_id = #{itemId}
        AND type = #{type}
        AND sync_time = #{syncTime}
        <if test="serverId != 0">
            AND server_id = #{serverId}
        </if>
    </select>
</mapper>